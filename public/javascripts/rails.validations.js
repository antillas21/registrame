(function(c){c.fn.validate=function(){return this.filter("form[data-validate]").each(function(){var g=c(this);var f=window[g.attr("id")];g.submit(function(){return g.isValid()}).bind("ajax:beforeSend",function(){return g.isValid()}).bind("form:validate:after",function(h){clientSideValidations.callbacks.form.after(g,h)}).bind("form:validate:before",function(h){clientSideValidations.callbacks.form.before(g,h)}).bind("form:validate:fail",function(h){clientSideValidations.callbacks.form.fail(g,h)}).bind("form:validate:pass",function(h){clientSideValidations.callbacks.form.pass(g,h)}).find("[data-validators]:input").live("focusout",function(){c(this).isValid()}).live("change",function(){c(this).data("changed",true)}).live("element:validate:after",function(h){clientSideValidations.callbacks.element.after(c(this),h)}).live("element:validate:before",function(h){clientSideValidations.callbacks.element.before(c(this),h)}).live("element:validate:fail",function(j,i){var h=c(this);clientSideValidations.callbacks.element.fail(h,i,function(){d(h,i)},j)}).live("element:validate:pass",function(i){var h=c(this);clientSideValidations.callbacks.element.pass(h,function(){e(h)},i)}).end().find("[data-validators]:checkbox").live("click",function(){c(this).isValid()}).end().find("[id*=_confirmation]").each(function(){var i=c(this),h=g.find("#"+this.id.match(/(.+)_confirmation/)[1]+"[data-validators]:input");c("#"+i.attr("id")).live("focusout",function(){h.data("changed",true).isValid()}).live("keyup",function(){h.data("changed",true).isValid()})});var d=function(h,i){clientSideValidations.formBuilders[f.type].add(h,f,i)};var e=function(h){clientSideValidations.formBuilders[f.type].remove(h,f)}})};c.fn.isValid=function(){if(c(this[0]).is("form")){return b(c(this[0]))}else{return a(c(this[0]))}};var b=function(e){var d=true;e.trigger("form:validate:before").find("[data-validators]:input").each(function(){if(!a(c(this))){d=false}});if(d){e.trigger("form:validate:pass")}else{e.trigger("form:validate:fail")}e.trigger("form:validate:after");return d};var a=function(e){e.trigger("element:validate:before");if(e.data("changed")!==false){var f=true,d=new Function("return "+e.attr("data-validators"))();e.data("changed",false);for(kind in clientSideValidations.validators.all()){if(d[kind]&&(message=clientSideValidations.validators.all()[kind](e,d[kind]))){e.trigger("element:validate:fail",message).data("valid",false);f=false;break}}if(f){e.data("valid",null);e.trigger("element:validate:pass")}}e.trigger("element:validate:after");return e.data("valid")===false?false:true};c(function(){c("form[data-validate]").validate()})})(jQuery);var clientSideValidations={validators:{all:function(){return jQuery.extend({},clientSideValidations.validators.local,clientSideValidations.validators.remote)},local:{presence:function(b,a){if(/^\s*$/.test(b.val())){return a.message}},acceptance:function(b,a){switch(b.attr("type")){case"checkbox":if(!b.attr("checked")){return a.message}break;case"text":if(b.val()!=(a.accept||"1")){return a.message}break}},format:function(b,a){if((message=this.presence(b,a))&&a.allow_blank==true){return}else{if(message){return message}else{if(a["with"]&&!a["with"].test(b.val())){return a.message}else{if(a.without&&a.without.test(b.val())){return a.message}}}}},numericality:function(d,c){if(!/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d*)?$/.test(d.val())){return c.messages.numericality}if(c.only_integer&&!/^\d+$/.test(d.val())){return c.messages.only_integer}var a={greater_than:">",greater_than_or_equal_to:">=",equal_to:"==",less_than:"<",less_than_or_equal_to:"<="};for(var b in a){if(c[b]&&!(new Function("return "+d.val()+a[b]+c[b])())){return c.messages[b]}}if(c.odd&&!(parseInt(d.val())%2)){return c.messages.odd}if(c.even&&(parseInt(d.val())%2)){return c.messages.even}},length:function(e,d){var c={};if(d.is){c.message=d.messages.is}else{if(d.minimum){c.message=d.messages.minimum}}if((message=this.presence(e,c))&&d.allow_blank==true&&!d.maximum){return}else{if(message){return message}else{var a={is:"==",minimum:">=",maximum:"<="};var f=d.js_tokenizer||"split('')";var g=new Function("element","return (element.val()."+f+" || '').length;")(e);for(var b in a){if(d[b]&&!(new Function("return "+g+a[b]+d[b])())){return d.messages[b]}}}}},exclusion:function(d,b){if((message=this.presence(d,b))&&b.allow_blank==true){return}else{if(message){return message}else{if(b["in"]){for(var c=0;c<b["in"].length;c++){if(b["in"][c]==d.val()){return b.message}}}else{if(b.range){var a=b.range[0],e=b.range[1];if(d.val()>=a&&d.val()<=e){return b.message}}}}}},inclusion:function(d,b){if((message=this.presence(d,b))&&b.allow_blank==true){return}else{if(message){return message}else{if(b["in"]){for(var c=0;c<b["in"].length;c++){if(b["in"][c]==d.val()){return}}return b.message}else{if(b.range){var a=b.range[0],e=b.range[1];if(d.val()>=a&&d.val()<=e){return}else{return b.message}}}}}},confirmation:function(b,a){if(b.val()!=jQuery("#"+b.attr("id")+"_confirmation").val()){return a.message}}},remote:{uniqueness:function(c,b){var e={};e.case_sensitive=!!b.case_sensitive;if(b.id){e.id=b.id}if(b.scope){e.scope={};for(key in b.scope){var d=jQuery('[name="'+c.attr("name").replace(/\[\w+]$/,"["+key+']"]'));if(d[0]&&d.val()!=b.scope[key]){e.scope[key]=d.val();d.unbind("change."+c.id).bind("change."+c.id,function(){c.trigger("change");c.trigger("focusout")})}else{e.scope[key]=b.scope[key]}}}if(/_attributes]/.test(c.attr("name"))){var a=c.attr("name").match(/\[\w+_attributes]/g).pop().match(/\[(\w+)_attributes]/).pop();a+=/(\[\w+])$/.exec(c.attr("name"))[1]}else{var a=c.attr("name")}e[a]=c.val();if(jQuery.ajax({url:"/validators/uniqueness.json",data:e,async:false}).status==200){return b.message}}}},formBuilders:{"ActionView::Helpers::FormBuilder":{add:function(c,d,e){if(c.data("valid")!==false){var a=jQuery(d.input_tag),f=jQuery(d.label_tag),b=jQuery('label[for="'+c.attr("id")+'"]:not(.message)');c.before(a);a.find("span#input_tag").replaceWith(c);a.find("label.message").attr("for",c.attr("id"));b.replaceWith(f);f.find("label#label_tag").replaceWith(b)}jQuery('label.message[for="'+c.attr("id")+'"]').text(e)},remove:function(d,e){var a=jQuery(e.input_tag).attr("class"),b=d.closest("."+a),c=jQuery('label[for="'+d.attr("id")+'"]:not(.message)'),f=c.closest("."+a);if(b[0]){b.find("#"+d.attr("id")).detach();b.replaceWith(d);c.detach();f.replaceWith(c)}}},"SimpleForm::FormBuilder":{add:function(b,c,d){if(b.data("valid")!==false){var e=b.closest(c.wrapper_tag);e.addClass(c.wrapper_error_class);var a=$("<"+c.error_tag+' class="'+c.error_class+'">'+d+"</"+c.error_tag+">");e.append(a)}else{b.parent().find(c.error_tag+"."+c.error_class).text(d)}},remove:function(b,c){var d=b.closest(c.wrapper_tag+"."+c.wrapper_error_class);d.removeClass(c.wrapper_error_class);var a=d.find(c.error_tag+"."+c.error_class);a.remove()}},"Formtastic::SemanticFormBuilder":{add:function(b,c,d){if(b.data("valid")!==false){var e=b.closest("li");e.addClass("error");var a=$('<p class="'+c.inline_error_class+'">'+d+"</p>");e.append(a)}else{b.parent().find("p."+c.inline_error_class).text(d)}},remove:function(b,c){var d=b.closest("li.error");d.removeClass("error");var a=d.find("p."+c.inline_error_class);a.remove()}}},callbacks:{element:{after:function(a,b){},before:function(a,b){},fail:function(b,d,a,c){a()},pass:function(a,b,c){b()}},form:{after:function(b,a){},before:function(b,a){},fail:function(b,a){},pass:function(b,a){}}}};